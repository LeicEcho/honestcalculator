<script>
    // --- BASE DE DATOS EXPANDIDA (TOP 50 STEAM + LATAM MARKET) ---
    // Scores basados en PassMark Multi-Thread (CPU) y G3D Mark (GPU) - Nov 2025
    const hardwareData = {
      "cpus": [
        { "name": "--- GAMA ULTRA / ENTHUSIAST ---", "score": 0 },
        { "name": "AMD Ryzen 9 9950X3D", "score": 70179 },
        { "name": "Intel Core Ultra 9 285K", "score": 67566 },
        { "name": "AMD Ryzen 9 7950X", "score": 63000 },
        { "name": "Intel Core i9-13900K", "score": 60000 },
        
        { "name": "--- GAMA ALTA (High End) ---", "score": 0 },
        { "name": "AMD Ryzen 7 7800X3D (God Tier Gaming)", "score": 35000 },
        { "name": "Intel Core i7-13700K", "score": 46000 },
        { "name": "AMD Ryzen 7 5800X3D", "score": 28295 },
        { "name": "Intel Core i5-13600K", "score": 38000 },
        { "name": "AMD Ryzen 7 5700X", "score": 26000 },
        
        { "name": "--- GAMA MEDIA (Mainstream) ---", "score": 0 },
        { "name": "Intel Core i5-13400F", "score": 25026 },
        { "name": "AMD Ryzen 5 7600 / 7600X", "score": 28000 },
        { "name": "AMD Ryzen 5 5600 / 5600X (Rey Calidad-Precio)", "score": 21549 },
        { "name": "Intel Core i5-12400F", "score": 19522 },
        { "name": "Intel Core i5-11400F", "score": 17000 },
        { "name": "AMD Ryzen 5 5500", "score": 19000 },
        
        { "name": "--- GAMA DE ENTRADA / ANTIGUOS (Legacy) ---", "score": 0 },
        { "name": "AMD Ryzen 5 3600 / 2600", "score": 17197 },
        { "name": "Intel Core i5-10400F", "score": 12500 },
        { "name": "AMD Ryzen 5 1600 (AF)", "score": 12000 },
        { "name": "Intel Core i3-12100F (El peque√±o gigante)", "score": 14000 },
        { "name": "Intel Core i3-10100F", "score": 8800 },
        { "name": "Intel Core i7-7700K (Leyenda vieja)", "score": 9000 },
        { "name": "AMD Ryzen 3 3200G (APU)", "score": 7200 },
        { "name": "Intel Core i5-9400F", "score": 9500 },
        { "name": "Intel Core i3-10110U (Laptop B√°sica)", "score": 3841 }
      ],
      "gpus": [
        { "name": "--- GAMA ULTRA (4K Monsters) ---", "score": 0 },
        { "name": "GeForce RTX 4090", "score": 38121 },
        { "name": "GeForce RTX 4080 / Super", "score": 34463 },
        { "name": "Radeon RX 7900 XTX", "score": 31000 },
        { "name": "GeForce RTX 4070 Ti", "score": 29000 },
        
        { "name": "--- GAMA ALTA (1440p Killers) ---", "score": 0 },
        { "name": "GeForce RTX 4070", "score": 26000 },
        { "name": "Radeon RX 7800 XT", "score": 25000 },
        { "name": "GeForce RTX 3080", "score": 24000 },
        { "name": "GeForce RTX 4060 Ti", "score": 23000 },
        { "name": "Radeon RX 6700 XT", "score": 22000 },
        
        { "name": "--- GAMA MEDIA (1080p Kings) ---", "score": 0 },
        { "name": "GeForce RTX 4060", "score": 22651 },
        { "name": "GeForce RTX 3060 Ti", "score": 20312 },
        { "name": "Radeon RX 7600", "score": 17000 },
        { "name": "Radeon RX 6600 XT", "score": 16455 },
        { "name": "GeForce RTX 3060 12GB", "score": 15206 },
        { "name": "GeForce RTX 2060 / Super", "score": 14000 },
        { "name": "Radeon RX 6600", "score": 13500 },
        
        { "name": "--- GAMA BAJA / BUDGET (Survivors) ---", "score": 0 },
        { "name": "GeForce GTX 1660 Super / Ti", "score": 12500 },
        { "name": "GeForce GTX 1070", "score": 13000 },
        { "name": "GeForce RTX 3050", "score": 12000 },
        { "name": "GeForce GTX 1650 Super", "score": 9800 },
        { "name": "GeForce GTX 1060 6GB", "score": 9813 },
        { "name": "Radeon RX 580 / 570 (8GB)", "score": 8700 },
        { "name": "GeForce GTX 1650 (Normal)", "score": 7500 },
        { "name": "GeForce GTX 1050 Ti", "score": 6000 },
        { "name": "Radeon RX 550 / GT 1030", "score": 2800 }
      ]
    };

    const cpuSelect = document.getElementById('cpuSelect');
    const gpuSelect = document.getElementById('gpuSelect');

    // Funci√≥n para llenar listas ignorando los separadores (score 0)
    function llenarLista(select, datos) {
        datos.forEach(item => {
            const option = new Option(item.name, item.score);
            if (item.score === 0) {
                option.disabled = true; // Deshabilitar t√≠tulos de secci√≥n
                option.style.fontWeight = "bold";
                option.style.color = "#00d2ff";
                option.style.backgroundColor = "#222";
            }
            select.add(option);
        });
    }

    llenarLista(cpuSelect, hardwareData.cpus);
    llenarLista(gpuSelect, hardwareData.gpus);

    function calcularBottleneck() {
        const cpuScore = parseInt(cpuSelect.value);
        const gpuScore = parseInt(gpuSelect.value);
        const resolution = parseInt(document.getElementById('resolution').value);
        const resultDiv = document.getElementById('resultado');

        if (cpuScore === 0 || gpuScore === 0 || isNaN(cpuScore) || isNaN(gpuScore)) {
            // Evitar que calculen seleccionando un t√≠tulo
            if (cpuScore === 0 || gpuScore === 0) return; 
            alert("Por favor selecciona componentes v√°lidos");
            return;
        }

        // --- L√ìGICA DIN√ÅMICA V2.3 (Ajustada para Gamers Low-End) ---
        let scaleFactor = 1.1; 
        
        // Ajuste fino de curvas de potencia
        if (gpuScore > 30000) { scaleFactor = 1.9; }       // Ultra High
        else if (gpuScore > 20000) { scaleFactor = 1.6; }  // High
        else if (gpuScore > 10000) { scaleFactor = 1.35; } // Mid
        else { scaleFactor = 1.1; }                        // Low / Entry

        const adjustedGpuScore = gpuScore * scaleFactor;
        
        let resModifier = 1.0;
        if (resolution === 1440) resModifier = 0.85;
        if (resolution === 2160) resModifier = 0.65;

        const ratio = (cpuScore * resModifier) / adjustedGpuScore;

        let titulo, texto, clase, colorBarra, porcentajeBarra;

        // Calibraci√≥n de zonas de diagn√≥stico
        if (ratio > 1.45) {
            clase = "warning";
            titulo = "‚ö†Ô∏è GPU LIMITANTE (Cuello Gr√°fico)";
            texto = "Tu CPU est√° sobrada para esta gr√°fica. No es malo, pero podr√≠as actualizar tu gr√°fica sin cambiar el procesador.";
            colorBarra = "#ffc107"; porcentajeBarra = "90%"; 
        } else if (ratio < 0.75) {
            clase = "danger";
            titulo = "üõë CPU LIMITANTE (Cuello de Procesador)";
            texto = "Tu procesador no puede seguirle el ritmo a la gr√°fica. Tendr√°s FPS inestables y tirones (stuttering) en juegos modernos.";
            colorBarra = "#dc3545"; porcentajeBarra = "20%";
        } else {
            clase = "safe";
            titulo = "‚úÖ SINERGIA EXCELENTE";
            texto = "¬°Gran equilibrio! Tus componentes trabajan en armon√≠a. Es una configuraci√≥n inteligente.";
            colorBarra = "#28a745"; porcentajeBarra = "50%";
        }

        resultDiv.style.display = "block";
        resultDiv.className = clase;
        resultDiv.innerHTML = `
            <h2 style="margin-top:0">${titulo}</h2>
            <p>${texto}</p>
            <div class="meter-container"><div class="meter-fill" style="width: ${porcentajeBarra}; background: ${colorBarra};"></div></div>
            <div class="debug-info">LeicEcho Engine V2.3 | Escala: x${scaleFactor} | Ratio: ${ratio
